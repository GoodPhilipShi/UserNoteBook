# Next.Jsæ¡†æ¶

## ğŸ¯ä»€ä¹ˆæ˜¯Next.Js

è¿™æ˜¯ä¸€ä¸ªç”¨äº ç”Ÿäº§ç¯å¢ƒçš„ React æ¡†æ¶.

Next.Jsä¸ºæ‚¨æä¾›ç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ä»¥åŠæœ€ä½³çš„å¼€å‘ä½“éªŒï¼šåŒ…æ‹¬é™æ€åŠæœåŠ¡å™¨ç«¯èåˆæ¸²æŸ“ã€ æ”¯æŒ TypeScriptã€æ™ºèƒ½åŒ–æ‰“åŒ…ã€ è·¯ç”±é¢„å–ç­‰åŠŸèƒ½ æ— éœ€ä»»ä½•é…ç½®. 

Next.Jsä¸»è¦ç”¨äºReactç¨‹åºçš„**SSR**(æœåŠ¡ç«¯æ¸²æŸ“) ,**SSR**ç®€å•ç†è§£æ˜¯å°†ç»„ä»¶æˆ–é¡µé¢é€šè¿‡æœåŠ¡å™¨ç”Ÿæˆhtmlå­—ç¬¦ä¸².  å†å‘é€åˆ°æµè§ˆå™¨.  æœ€åå°†é™æ€æ ‡è®°"æ··åˆ"ä¸ºå®¢æˆ·ç«¯ä¸Šå®Œå…¨äº¤äº’çš„åº”ç”¨ç¨‹åº.

**CSR**(å®¢æˆ·ç«¯æ¸²æŸ“)é¦–æ¬¡åŠ è½½çš„æ—¶å€™éœ€è¦æŠŠæ‰€æœ‰ç›¸å…³çš„é™æ€èµ„æºåŠ è½½å®Œæ¯•.  ç„¶åæ ¸å¿ƒJSæ‰ä¼šå¼€å§‹æ‰§è¡Œ.  è¿™ä¸ªè¿‡ç¨‹ä¼šæ¶ˆè€—ä¸€å®šçš„æ—¶é—´.  æ¥ç€è¿˜ä¼šè¯·æ±‚ç½‘ç»œæ¥å£.  æœ€ç»ˆæ‰èƒ½å®Œå…¨æ¸²æŸ“å®Œæˆ.

**SSR**åç«¯æ‹¦æˆªåˆ°è·¯ç”±.  æ‰¾åˆ°å¯¹åº”ç»„ä»¶.  å¼€å§‹æ¸²æŸ“ç»„ä»¶.  æ‰€æœ‰çš„ JS èµ„æºåœ¨æœåŠ¡å™¨æœ¬åœ°. æ’é™¤äº†JSèµ„æºçš„ç½‘ç»œåŠ è½½æ—¶é—´.  æ¥ç€åªéœ€è¦å¯¹å½“å‰è·¯ç”±çš„ç»„ä»¶è¿›è¡Œæ¸²æŸ“. è‡³äºé¡µé¢çš„æœåŠ¡è¯·æ±‚.  å¦‚æœåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Š.  é€Ÿåº¦ä¹Ÿä¼šå¿«å¾ˆå¤š. æœ€ååç«¯æŠŠæ¸²æŸ“å¥½çš„é¡µé¢åå›ç»™å‰ç«¯.  å‰ç«¯æ„å»ºDOMçš„æ•ˆç‡å¤§å¤§æé«˜. 

ç›¸æ¯”ä¹‹ä¸‹.  **SSR**èƒ½æ›´å¿«åœ°å±•ç¤ºå‡ºé¡µé¢çš„å†…å®¹.  é™ä½å®¢æˆ·ç«¯ç­‰å¾…æ—¶é—´ã€‚**SEO**åœ¨çˆ¬å–é¡µé¢ä¿¡æ¯çš„æ—¶å€™.  ä¼šå‘é€**HTTPè¯·æ±‚**æ¥è·å–ç½‘é¡µå†…å®¹.  è€ŒæœåŠ¡ç«¯æ¸²æŸ“é¦–æ¬¡çš„æ•°æ®æ˜¯åç«¯è¿”å›çš„.  è¿”å›çš„æ—¶å€™å·²ç»æ˜¯æ¸²æŸ“å®Œæˆçš„ titleã€å†…å®¹ç­‰ä¿¡æ¯.  ä¾¿äºçˆ¬è™«æŠ“å–å†…å®¹ã€‚ä½†åŒæ—¶**SSR**ä¹Ÿä¼šå¯¹æœåŠ¡å™¨çš„æ€§èƒ½æœ‰è¾ƒé«˜çš„è¦æ±‚ã€‚

## ğŸŒNext.Jså¿«é€Ÿå¼€å§‹

### âš™ç¯å¢ƒè¦æ±‚

- **Node.js 10.13**æˆ–æ›´é«˜ç‰ˆæœ¬
- MacOSã€Windows (åŒ…æ‹¬ WSL) å’Œ Linux éƒ½è¢«æ”¯æŒ

### ğŸ› åˆ›å»ºæ–°çš„Next.Jsåº”ç”¨ç¨‹åº

#### ğŸš©æ¨è: ä½¿ç”¨`create-next-app`åˆ›å»º

1. å®‰è£… `create-next-app`

    > å®‰è£…æ–¹æ³•å¦‚ä¸‹:
    >
    > ```shell
    > npm install -g create-next-app
    > ```

2. ä½¿ç”¨`create-next-app`

    æ–¹æ³•1: ç›´æ¥ä½¿ç”¨
    
    
    ```shell
    create-next-app my-app
    ```
    > my-app å°±æ˜¯ç¨‹åºåç§°
    
    æ–¹æ³•2: ä½¿ç”¨npxåˆ›å»º
    
    ```shell
    npx create-next-app my-app
    ```
    æ–¹æ³•3: ä½¿ç”¨yarnåˆ›å»º
    
    ```shell
    yarn create-next-app my-app
    ```
    
    > å¦å¤–.  å¦‚æœä½ å¸Œæœ›ä½¿ç”¨ TypeScript å¼€å‘é¡¹ç›®.  å¯ä»¥é€šè¿‡ `--typescript` å‚æ•°åˆ›å»º TypeScript é¡¹ç›®
    > ```shell
    > create-next-app my-app --typescript
    > # or
    > npx create-next-app my-app --typescript
    > yarn create-next-app my-app --typescript
    > ```

#### ğŸ’¡å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±åˆ›å»º
> å¦‚æœä½ å¾ˆç†Ÿæ‚‰çš„è¯

### ğŸˆåˆ›å»ºå®Œæˆå

ç¬¬ä¸€ä»¶äº‹. å°±æ˜¯å…ˆè¿è¡Œé¡¹ç›®[å³.  ä»¥å¼€å‘æ¨¡å¼å¯åŠ¨ Next.js]
```shell
npm run dev
```

> å¦‚æœè¿è¡Œæ²¡æœ‰ä»»ä½•é—®é¢˜.  åˆ™è¡¨æ˜Next.Jsåº”ç”¨ç¨‹åºæ­å»ºå®Œæˆ

## ğŸ‘€Next.Jsé¡¹ç›®æ–‡ä»¶é¢„è§ˆ

```tree
â”œâ”€node_modules
â”œâ”€pages
â”‚  â”œâ”€api
â”‚  â”‚  â””â”€index.js
â”‚  â”œâ”€_app.js
â”‚  â””â”€index.js
â”œâ”€public
â””â”€styles
   â”œâ”€Home.module.css
   â””â”€globals.css
```

> Next.Jsåº”ç”¨ç¨‹åº å’Œ React åº”ç”¨ç¨‹åºå¤§è‡´ç›¸åŒ.  éƒ½æ˜¯æŠŠindex.jsä½œä¸ºå…¥å£å‡½æ•°
>
> æŠŠpages(Next.Js)çœ‹ä½œsrc(React).  å°±å¾ˆå¥½ç†è§£äº†å§

## ğŸ¤¡Next.Jsçš„ç‰¹æ€§

> å°±æ˜¯è‡ªæˆ‘çš„æ€»ç»“.  æ¯”è¾ƒç‰‡é¢

- Next.Jsçš„**æ´»**è·¯ç”±

    `pages` ç›®å½•çš„ä»»ä½•( `.js`ã€`jsx`ã€`.ts` æˆ– `.tsx` )æ–‡ä»¶.  éƒ½ä¼šè¢«Next.Jsä½¿ç”¨å…¶æ–‡ä»¶åä½œä¸ºè·¯ç”±

- Next.Jsçš„åŠ¨æ€è·¯ç”±

    ä¾‹å¦‚: åˆ›å»ºæ–‡ä»¶`pages/post/[pid].js`

    ```javascript
    import { useRouter } from 'next/router'
    
    const Post = () => {
      const router = useRouter()
      const { pid } = router.query
    
      return <p>Post: {pid}</p>
    }
    
    export default Post
    ```
    > ä¸è¦è¢«`Post`ã€`post`è¿™äº›å•è¯ç»™è¿·æƒ‘äº†
    
    > è®¿é—®: http://localhost:3000/post/1
    > å°±ä¼šè·³è½¬åˆ°æ˜¾ç¤º`<p>Post: 1</p>`è¿™æ ·çš„ç½‘é¡µ
    
- Next.Jsçš„Apiè·¯ç”±

    ä¾‹å¦‚: åˆ›å»ºæ–‡ä»¶`pages/api/post/index.js`

      ```javascript
    export default (req.  res) => {
        res.statusCode = 200;
        res.setHeader("Content-Type".  "application/json");
        res.end(
            JSON.stringify({
                message: "è¿™é‡Œæ˜¯è¿”å›è¯·æ±‚ä¿¡æ¯Api". 
                method: `å½“å‰ä¸º${req.method}`. 
                data: `è¯·æ±‚ä¿¡æ¯å¦‚ä¸‹: ${JSON.stringify(req.method == "GET"?req.query:req.body)}`. 
            })
        );
    };
      ```
    
    > è®¿é—®: http://localhost:3000/api/post?id=12345
    > å°±ä¼šè¿”å›JSONä¿¡æ¯
    >
    > ![image-20210721160432909](image-20210721160432909.png)
    
    > å½“ç„¶.  æ™®é€šè·¯ç”±æœ‰åŠ¨æ€è·¯ç”±.  Apiè·¯ç”±ä¹ŸåŒæ ·æ‹¥æœ‰åŠ¨æ€Apiè·¯ç”±
    
- Next.Jsçš„åŠ¨æ€Apiè·¯ç”±

    ä¾‹å¦‚: åˆ›å»ºæ–‡ä»¶`pages/api/post/[id].js`

      ```javascript
    export default (req.  res) => {
        res.statusCode = 200;
        res.setHeader("Content-Type".  "application/json");
        res.end(
            JSON.stringify({
                message: "è¿™é‡Œæ˜¯è¿”å›è¯·æ±‚ä¿¡æ¯Api". 
                method: `å½“å‰ä¸º${req.method}`. 
                data: `è¯·æ±‚ä¿¡æ¯å¦‚ä¸‹: ${JSON.stringify(req.method == "GET"?req.query:req.body)}`. 
            })
        );
    };
      ```
    
    > è®¿é—®: http://localhost:3000/api/post/123
    > å°±ä¼šè¿”å›JSONä¿¡æ¯
    >
    > ![image-20210721160809758](image-20210721160809758.png)
    

> æ›´å¤šè¯¦ç»†å†…å®¹.  è¯·è‡ªè¡Œè§‚çœ‹å®˜æ–¹æ–‡æ¡£

## å…³äºDEMO

### æè¿°

å¤§è‡´ä¸Šçš„å°†Next.Jsæ¡†æ¶å’ŒBoostrapã€Ant Designã€Jqueryã€Axiosè¿›è¡Œç»“åˆ.  æ²¡æœ‰åšä»€ä¹ˆç»†èŠ‚ä¸Šçš„ä¼˜åŒ–. ä¸»è¦ä½¿ç”¨äº†Next.Jsæ¡†æ¶ä¸‹çš„è·¯ç”±å’ŒApi. 

### ç»„æˆ

åˆ†ä¸º5ä¸ªéƒ¨åˆ†.  ä»‹ç»é¡µé¢ã€Boostrapä¾‹å­ã€Ant Designä¾‹å­ã€Jqueryä¾‹å­ã€Axiosä¾‹å­

#### ä»‹ç»é¡µé¢

![image-20210721161151249](image-20210721161151249.png)

> ä»‹ç»ä¸€äº›æ¯ä¸ªä¾‹å­å¤§å¤§æ¦‚å†…å®¹

#### Boostrapä¾‹å­

![image-20210721161210745](image-20210721161210745.png)

> æè¿°Apiè·¯ç”±çš„ä¿¡æ¯

#### Ant Designä¾‹å­

![image-20210721161227239](image-20210721161227239.png)

> è¡¨å•çš„æœç´¢åŠŸèƒ½çš„å®ç°

#### Jqueryä¾‹å­

![image-20210721161236614](image-20210721161236614.png)

> å­—é¢æ„æ€

#### Axiosä¾‹å­

![image-20210721161312367](image-20210721161312367.png)

![image-20210721165139616](image-20210721165139616.png)

> å¯¹Apiè·¯ç”±çš„è®¿é—®

### â“æ˜¯å¦‚ä½•åœ¨Next.Jsä¸­ä½¿ç”¨

#### Bootstrap

> [react-bootstrapå®˜ç½‘](https://react-bootstrap.github.io/)
>
> [bootstrapå®˜ç½‘](https://v5.bootcss.com/docs/getting-started/introduction/)

| ä½¿ç”¨æ–¹æ³•                             | ä¼˜ç‚¹                                                         | ç¼ºç‚¹                                                         |
| ------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ä½¿ç”¨`react-bootstrap`                | 1. ç®€å•.  ä¸€ä¸ª`npm i`å°±ä¸‹è½½å®Œæ¯•<br />2. å†™èµ·æ¥ç®€å•.  å°±æ˜¯ç”¨ç»„ä»¶æ¥å†™ | 1. ä¸å¤Ÿå¥½çœ‹<br />2. ä¸è‡ªå¸¦Bootstrapçš„CSSæ ·å¼<br />3. æä¾›ç»„ä»¶ä¸å¤Ÿå¤š.  ç»„ä»¶Apiä¸è¡Œ |
| âœ³ç›´æ¥é€šè¿‡`JavaScript`ä½¿ç”¨`bootstrap` | 1. ç›´æ¥ `JavaScript`ä»£ç é£èµ·.  ä¼šå†™å°±å¾ˆæ–¹ä¾¿.  ä¸ä¼šå†™å°±ä¸æ–¹ä¾¿ | 1. ä¸å¤Ÿå¥½çœ‹                                                  |

#### Ant Design

> [Ant Designå®˜ç½‘](https://ant.design/docs/react/introduce-cn)

| ä½¿ç”¨æ–¹æ³•   | ä¼˜ç‚¹                                                         | ç¼ºç‚¹                              |
| ---------- | ------------------------------------------------------------ | --------------------------------- |
| ä½¿ç”¨`antd` | 1. ç®€å•.  ä¸€ä¸ª`npm i`å°±ä¸‹è½½å®Œæ¯•<br />2. å†™èµ·æ¥ç®€å•.  å°±æ˜¯ç”¨ç»„ä»¶æ¥å†™<br />3. è‡ªå¸¦Ant Designçš„CSSæ ·å¼ | 1. ç»„ä»¶Apiè¶³å¤Ÿå¤š.  çœ¼ç›éƒ½è¦çœ‹èŠ±çœ¼ |

#### Jqueryä¾‹å­

| ä½¿ç”¨æ–¹æ³•     | ä¼˜ç‚¹                                                       | ç¼ºç‚¹ |
| ------------ | ---------------------------------------------------------- | ---- |
| ä½¿ç”¨`jquery` | 1. ç®€å•.  ä¸€ä¸ª`npm i`å°±ä¸‹è½½å®Œæ¯•<br />2. è€ç‰Œ`JavaScript`åº“ |      |

#### Axiosä¾‹å­

> [Axioså®˜ç½‘](http://www.axios-js.com/zh-cn/docs/)

| ä½¿ç”¨æ–¹æ³•                         | ä¼˜ç‚¹                                                         | ç¼ºç‚¹                |
| -------------------------------- | ------------------------------------------------------------ | ------------------- |
| ä½¿ç”¨`react-axios`                | 1. ç®€å•.  ä¸€ä¸ª`npm i`å°±ä¸‹è½½å®Œæ¯•<br />2. å†™èµ·æ¥ç®€å•.  å°±æ˜¯ç”¨ç»„ä»¶æ¥å†™ | 1. ä½¿ç”¨èµ·æ¥ä¸å¤Ÿçµæ´» |
| âœ³ç›´æ¥é€šè¿‡`JavaScript`ä½¿ç”¨`axios` | 1. ç›´æ¥ `JavaScript`ä»£ç é£èµ·.  ä¼šå†™å°±å¾ˆæ–¹ä¾¿.  ä¸ä¼šå†™å°±ä¸æ–¹ä¾¿ |                     |

### DEMOçš„GIFç¤ºæ„å›¾

![åŠ¨ç”»](åŠ¨ç”»1.gif)
